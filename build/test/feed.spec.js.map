{"version":3,"sources":["../../api/v1/test/feed.spec.js"],"names":["dotenv","config","process","env","NODE_ENV","save","User","deleteAllUsers","saveArticle","Article","deleteAllArticles","saveGif","Gif","deleteAllGifs","deleteAllComments","Comment","hashPassword","helper","generateToken","chai","use","chaiHttp","describe","id1","obj","sub","role","token","before","articleTitle","articleText","date","format","userValues","articleValues","gifTitle","gUrl","p_id","gifValues","after","it","request","server","get","set","res","to","have","status","body","data","be","an","equals"],"mappings":"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","sourcesContent":["import chai, { expect } from 'chai';\nimport chaiHttp from 'chai-http';\nimport 'chai/register-should';\nimport dotenv from 'dotenv';\nimport moment from 'moment';\nimport uuidv1 from 'uuid/v1';\nimport server from '../server';\nimport Gif from '../models/gif';\nimport User from '../models/user';\nimport Article from '../models/article';\nimport Comment from '../models/comment';\nimport helper from '../controllers/helper';\n\ndotenv.config();\n\nprocess.env.NODE_ENV = 'test';\n\nconst { save, deleteAllUsers } = User;\nconst { saveArticle, deleteAllArticles } = Article;\nconst { saveGif, deleteAllGifs } = Gif;\nconst { deleteAllComments } = Comment;\n\nconst { hashPassword, generateToken} = helper;\n\nchai.use(chaiHttp);\n\ndescribe('comments', () => {\n  const id1 = uuidv1();\n  const obj = generateToken({ sub: id1, role: 'ADMIN' });\n  const token = `Bearer ${obj}`;\n  before(async () => {\n    const articleTitle = 'First test title';\n    const articleText = 'First test article test';\n    const date = moment().format('YYYY-MM-DD HH:mm:ss');\n\n    const userValues = [id1, 'Daniel', 'Mukuna', 'daniel@mukuna.com', hashPassword('DANIEL12345'), 'male', 'admin', 'I.T', 'thika'];\n    const articleValues = [1, articleTitle, articleText, date, id1];\n\n    const gifTitle = 'First gif test value';\n    const gUrl = 'http://res.cloudinary.com/mukuna/image/upload/v1574479438/teamwork-api-gifs/utvsco0pt6suogvzfbu9.gif';\n    const p_id = 'teamwork-api-gifs/utvsco0pt6suogvzfbu9';\n\n    const gifValues = [1, gifTitle, gUrl, p_id, date, id1];\n    await save(userValues);\n    await saveGif(gifValues);\n    await saveArticle(articleValues);\n  });\n\n  after(async () => {\n    await deleteAllGifs();\n    await deleteAllArticles();\n    await deleteAllUsers();\n  });\n\n  describe('GET /api/v1/feeds', () => {\n    it('should fetch all articles and gifs', async () => {\n      const res = await chai.request(server)\n        .get('/api/v1/feed')\n        .set('Authorization', token)\n        .set('Content-Type', 'application/json');\n        expect(res).to.have.status(200);\n        expect(res.body.data).to.be.an('array');\n        expect(res.body.status).to.be.equals('success');\n    });\n  });\n});\n"],"file":"feed.spec.js"}