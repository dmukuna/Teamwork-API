{"version":3,"sources":["../../api/v1/middleware/auth.js"],"names":["authorize","roles","secret","process","env","SECRET","req","res","next","case1","length","includes","user","role","case2","status","json","message"],"mappings":";;;;;;;;;AAAA;;AAEA,IAAMA,SAAS,GAAG,SAAZA,SAAY,CAACC,KAAD;AAAA,SAAW,CAC3B,4BAAW;AAAEC,IAAAA,MAAM,EAAEC,OAAO,CAACC,GAAR,CAAYC;AAAtB,GAAX,CAD2B,EAG3B,UAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAClB,QAAMC,KAAK,GAAGR,KAAK,CAACS,MAAN,IAAgBT,KAAK,CAACU,QAAN,CAAeL,GAAG,CAACM,IAAJ,CAASC,IAAxB,CAA9B;AACA,QAAMC,KAAK,GAAG,CAACb,KAAK,CAACS,MAAP,IAAiB,CAACT,KAAK,CAACU,QAAN,CAAeL,GAAG,CAACM,IAAJ,CAASC,IAAxB,CAAhC;;AACA,QAAIJ,KAAK,IAAIK,KAAb,EAAoB;AAClB,aAAON,IAAI,EAAX;AACD,KALiB,CAMlB;;;AACA,WAAOD,GAAG,CAACQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,MAAAA,MAAM,EAAE,OADkB;AAE1BE,MAAAA,OAAO,EAAE;AAFiB,KAArB,CAAP;AAID,GAd0B,CAAX;AAAA,CAAlB;;eAiBejB,S","sourcesContent":["import expressJwt from 'express-jwt';\r\n\r\nconst authorize = (roles) => [\r\n  expressJwt({ secret: process.env.SECRET }),\r\n\r\n  (req, res, next) => {\r\n    const case1 = roles.length && roles.includes(req.user.role);\r\n    const case2 = !roles.length && !roles.includes(req.user.role);\r\n    if (case1 || case2) {\r\n      return next();\r\n    }\r\n    // user's role is not authorized\r\n    return res.status(401).json({\r\n      status: 'Error',\r\n      message: 'Unauthorized',\r\n    });\r\n  },\r\n];\r\n\r\nexport default authorize;\r\n"],"file":"auth.js"}